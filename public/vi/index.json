[
{
	"uri": "/vi/1-intro/",
	"title": "Giới thiệu",
	"tags": [],
	"description": "",
	"content": "Tình huống Công ty của bạn mới sử dụng cloud và đang dần chuyển workload sang môi trường cloud. Với vai trò là security analyst, bạn có trách nhiệm thiết lập một giải pháp có thể phát hiện các mối đe dọa trên account và resources để bạn có thể ưu tiên và xử lí một cách hợp lí.\nBài workshop này sẽ chia thành 3 phần.\nGiới thiệu Amazon GuardDuty Phát hiện mối đe dọa và xử lí tình huống Dùng Amazon Detective để dò xét Architecture Đối với bài workshop này, chúng ta sử dụng CloudFormation để khởi chạy infrastructure và AWS services nhằm mô phỏng real application environment. Nhiều EC2 instances và các resource khác được tạo ra. Các resource trong environment, bao gồm các EC2 instance sẽ không được configure theo các best practices nhằm mô phỏng các security events để demo GuardDuty. Để hiểu rõ hơn các best practices về VPC security (https://docs.aws.amazon.com/vpc/latest/userguide/vpc-security-best-practices.html) và EC2 best practices (https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-best-practices.html), hãy đọc tài liệu của AWS.\nNhiều AWS security services được configure bằng CloudFormation khi bắt đầu buổi workshop. Những services này bao gồm:\nAmazon GuardDuty Amazon Detective AWS Security Hub "
},
{
	"uri": "/vi/",
	"title": "Phát hiện và ứng phó mối đe dọa bằng Amazon GuardDuty và Amazon Detective",
	"tags": [],
	"description": "",
	"content": "Tổng quan GuardDuty là service phát hiện mối đe dọa thông minh, liên tục giám sát các tài khoản AWS của bạn, các EC2 instances, các EKS clusters và dữ liệu được lưu trữ trong S3 để phát hiện hoạt động độc hại mà không cần sử dụng security software và agents. Nếu phát hiện hoạt động độc hại tiềm ẩn, chẳng hạn như hành vi bất thường, đánh cắp thông tin xác thực hoặc control infrastructure (C2) communication, GuardDuty sẽ tạo ra các phát hiện bảo mật chi tiết có thể được sử dụng để hiển thị bảo mật và hỗ trợ khắc phục. Ngoài ra, việc sử dụng tính năng Malware Protection của Amazon GuardDuty giúp phát hiện các tệp độc hại trên các Amazon Elastic Block Store (EBS) được đính kèm với EC2 instance và container workloads.\nAmazon Detective đơn giản hóa quy trình điều tra và giúp các nhóm bảo mật tiến hành điều tra nhanh hơn và hiệu quả hơn. Các tập hợp, tóm tắt và bối cảnh dữ liệu dựng sẵn của Amazon Detective giúp bạn nhanh chóng phân tích và xác định bản chất cũng như mức độ của các vấn đề bảo mật có thể xảy ra. Amazon Detective duy trì dữ liệu tổng hợp lên đến một năm và cung cấp dữ liệu đó một cách dễ dàng thông qua một bộ hình ảnh trực quan cho thấy những thay đổi về loại và khối lượng hoạt động trong một khoảng thời gian đã chọn, đồng thời liên kết những thay đổi đó với các phát hiện bảo mật.\nTrong bài workshop này, hãy tìm hiểu kiến thức cơ bản về Amazpm GuardDuty và Amazon Detective, đồng thời đi sâu vào các trường hợp và tình huống sử dụng khác nhau.\nNội dung Giới thiệu Giới thiệu Amazon GuardDuty Sử dụng Amazon Detective để điều tra "
},
{
	"uri": "/vi/3-detective/3.1-walkthrough/",
	"title": "Tìm hiểu Amazon Detective",
	"tags": [],
	"description": "",
	"content": "Amazon Detective cho phép bạn phân tích, điều tra và xác định nguyên nhân gốc rễ của các security findings hoặc hoạt động đáng ngờ. Detective thu thập các event dựa trên thời gian như số lần đăng nhập, API calls, network traffic từ AWS CloudTrail và Amazon VPC flow logs, các findings được nhập từ Amazon GuardDuty và Amazon EKS audit logs.\nAmazon Detective truy xuất log data, sau đó implement machine learning, phân tích thống kê và lý thuyết đồ thị để tạo hình ảnh trực quan nhằm điều tra bảo mật nhanh chóng và hiệu quả. Các tập hợp, tóm tắt và bối cảnh dữ liệu được tạo sẵn có trong Detective cho phép bạn nhanh chóng phân tích và xác định bản chất cũng như mức độ bảo mật.\nAmazon Detective Đầu tiên, các bạn hãy vào Amazon Detective. Chúng ta sẽ thấy 4 panels đó là:\nFinding groups: cho phép bạn phân tích nhiều hoạt động liên quán đến event xâm phạm bảo mật. Roles and users with the most API Call volume: cung cấp những users và roles có số lượng lệnh gọi API lớn nhất trong 24 giờ qua. EC2 instances with the most traffic volume: liệt kê các phiên bản EC2 có lưu lượng truy cập lớn nhất trong 24 giờ trước theo byte. EKS clusters with the most Kubernetes pods created Newly observed Geolocations: liệt kê các vị trí địa lý mà lệnh gọi API bắt nguồn trong 24 giờ trước đó nhưng lệnh gọi không bắt nguồn từ đó trong khoảng thời gian cơ sở. Tương quan giữa suspicious activity (hoạt động đáng ngờ) và Findings Groups Bạn có thể sử dụng các finding groups để trợ giúp cho việc điều tra của mình. Finding group của Amazon Detective cho phép bạn kiểm tra nhiều hoạt động liên quan đến một event xâm phạm bảo mật. Nếu kẻ đe dọa đang cố gắng xâm phạm AWS environment của bạn, chúng thường thực hiện một chuỗi hành động dẫn đến nhiều phát hiện bảo mật và hành vi bất thường. Những hành động này thường được trải rộng theo thời gian và các thực thể. Khi các phát hiện về bảo mật được điều tra riêng lẻ, điều này có thể dẫn đến hiểu sai về tầm quan trọng của chúng và gây khó khăn trong việc tìm ra nguyên nhân gốc rễ. Amazon Detective giải quyết vấn đề này bằng cách áp dụng kỹ thuật phân tích biểu đồ để suy ra mối quan hệ giữa các phát hiện và nhóm chúng lại với nhau. Chúng tôi khuyên bạn nên coi các finding groups là điểm khởi đầu để điều tra các thực thể và phát hiện có liên quan.\nDetective phân tích dữ liệu từ các findings và nhóm chúng với các findings khác có khả năng liên quan dựa trên các resources mà chúng chia sẻ. Ví dụ: các findings được kích hoạt bởi các hành động được thực hiện bởi cùng các IAM role sessions hoặc bắt nguồn từ cùng một địa chỉ IP rất có thể là một phần của cùng một hoạt động cơ bản. Sẽ rất có giá trị khi điều tra các findings và bằng chứng theo nhóm ngay cả khi các mối liên hệ do Detective đưa ra không liên quan.\nNgoài các findings, mỗi nhóm bao gồm các thực thể có liên quan đến các findings đó. Các thực thể có thể bao gồm các resources bên ngoài AWS như IP Address hoặc tác nhân người dùng.\nĐiều tra dựa vào API call volume Đầu tiên, các bạn vào trang Detective summary. Panel thứ hai là danh sách users và roles có số lượng API calls nhiều nhất trong 24 giờ qua.\nMỗi phần cho bạn biết Principal (role/user), AWS account, weekly trend, number of successful API calls, number of failed API calls và total calls. Weekly trend cho phép bạn phân tích trực quan xem số lượng API calls trong 7 ngày qua có bất thường hay không, điều này cho phéo bạn dễ dàng phát hiện các xu hướng bất thường đối với từng principal.\nĐiều tra dựa vào lưu lượng truy cập EC2 instances Đầu tiên, các bạn vào trang Detective summary. Panel thứ ba thể hiện EC2 instances with the most traffic volume là danh sách các EC2 instance có lưu lượng truy cập cao nhất trong 24 giờ qua bằng bytes.\nMỗi phần cho bạn biết lưu lượng đi vào và đi ra trong 24 giờ cũng như timeline của lưu lượng truy cập đó trong 7 ngày. Việc xác định hành vi bất thường chẳng hạn như tăng đột biến trong trend có thể được ghi nhận là hoạt động đáng ngờ cần được điều tra.\nPhân tích API origins Đầu tiên, các bạn vào trang Detective summary. Panel thứ tư là Newly observed geolocations. Panel này hiển thị vị trí địa lí nơi các API calls originated trong 24 giờ qua. Panel này cũng có thể chứa lên đến 100 vị trí, nó được highlight trên map và có thể chọn.\nSearch Capabilities Nếu bạn muốn tìm kiếm thông qua Amazon Detective để tìm Amazon GuardDuty finding cụ thể bằng cách sử dụng kí tự đại diện hoặc mã định danh được đề xuất. Hãy làm như sau, đầu tiên các bạn hãy vào Detective console. Chọn Search ở thanh điều hướng. Ở dưới Search, chọn nút Choose type để chọn các loại entity hoặc resource mà bạn muốn tìm kiếm và nhập vào thanh tìm kiếm.\nAmazon Detective Pricing Detective pricing dựa trên data volume được nhập AWS CloudTrail logs, Amazon Virtual Private Cloud (Amazon VPC) Flow Logs, Amazon Elastic Kubernetes Service (Amazon EKS) audit logs và Amazon GuardDuty findings. Các khoản phí được tính trên mỗi Gigabyte (GB) được nạp vào mỗi account/region/month. Bạn sẽ không bị tính phí khi kích hoạt các log sources này để phân tích hoặc cho dữ liệu được lưu trữ trong Amazon Detective.\nBạn có thể dùng thử Amazon Detective miễn phí với bản dùng thử miễn phí 30 ngày. Bản dùng thử miễn phí cho phép bạn nhận được bộ tính năng Amazon Detective đầy đủ trong khoảng thời gian 30 ngày.\nĐể có được chi phí ước tính cho data volume đã nhập, đầu tiên, các bạn hãy vào Detective console. Click vào Usage trên thanh điều hướng, ở đây nó sẽ hiển thị chi phí trong khoảng thời gian 30 ngày của account được tính dựa vào source package.\n"
},
{
	"uri": "/vi/2-guardduty/2.1-walkthrough/",
	"title": "Tổng quan Amazon GuardDuty",
	"tags": [],
	"description": "",
	"content": "Amazon GuardDuty cung cấp khả năng phát hiện mối đe dọa cho phép bạn liên tục giám sát và bảo vệ account AWS, workloads và dữ liệu được lưu trữ trong Amazon S3. GuardDuty phân tích các metadata streams liên tục được tạo từ account của bạn và network activity được tìm thấy trong AWS CloudTrail Events, VPC Flow Logs, và DNS Logs. GuardDuty cũng sử dụng thông tin tình báo về mối đe dọa tích hợp như địa chỉ IP độc hại, phát hiện bất thường, machine learning để xác định chính xác hơn các mối đe dọa.\nGuardDuty hoạt động hoàn toàn độc lập với resource của bạn, do đó không có nguy cơ ảnh hưởng đến hiệu suất hoặc tính khả dụng đối với workload của bạn. Service này được quản lí hoàn toàn với thông tin về mối đe dọa tích hợp, phát hiện bát thường và machine learning. Amazon GuardDuty cung cấp các cảnh báo chi tiết và hữu ích, dễ dàng tích hợp các hệ thống quy trình làm việc và quản lí event hiện có. Không có chi phí trả trước và bạn chỉ phải trả tiền cho các event được phân tích mà không cần phải có phần mềm bổ sung để deploy hoặc đăng kí nguồn cấp dữ liệu thông tin về các mối đe dọa.\nGuardDuty đã được kích hoạt khi chạy CloudFormation\nAmazon GuardDuty Đến trang Amazon GuardDuty, chúng ta sẽ thấy trang Summary cung cấp tổng quan và trực quan về các findings trong account của bạn.\nMở trang Findings, nó sẽ hiển thị các findings trong account này. GuardDuty finding thể hiện một vấn đề bảo mật tiềm ẩn được phát hiện trong network của bạn. GuardDuty đưa ra finding bất cứ khi nào phát hiện thấy hoạt động bất ngờ và có khả năng gây hại trong môi AWS environment của bạn.\nTìm kiếm và lọc GuardDuty Findings Bộ lọc findings cho phép bạn xem các findings phù hợp với tiêu chí bạn chỉ định và lọc ra mọi findings chưa khớp. Bộ lọc findings có thể được tạo và kiểm tra thông qua GuardDuty console. Bạn có thể lưu lại các filters được tạo thông qua console để sử dụng trong các quy tắc loại bỏ hoặc các hoạt động filter trong tương lai. Filter được tạo thành từ ít nhất một tiêu chí lọc, bao gồm một filter attribute được ghép nối với ít nhất một giá trị.\nClick vào thanh tìm kiếm, nhập Severity và click chọn nó, nó sẽ mở ra menu nhỏ với lựa chọn Low, Medium, High. Check vào High và click Apply, nó sẽ cập nhật nhưng findings tương ứng.\nGiá của Amazon GuardDuty Các tier price của GuardDuty bao gồm foundational pricing, là mức giá mặc định của phạm vi service, cũng như giá của các gói bảo vệ tùy chọn. Khi kích hoạt GuardDuty lần đầu tiên, bạn sẽ tự động bật các biện pháp bảo vệ cơ bản và gói bảo vệ tùy chọn, ngoại trừ tính năng Amazon EKS Runtime Monitoring có thể được kích hoạt riêng. Mặc dù bạn có thể tắt mọi tính năng bảo vệ tùy chọn bất kì lúc nào, nhưng các biện pháp bảo vệ cơ bản là bắt buộc đối với các tài khoản kích hoạt GuardDuty. Service logs được phân tích, được lọc để tối ưu hóa chi phí và được tích hợp trực tiếp với GuardDuty, nghĩa là bạn không cần phải kích hoạt hoặc thanh toán riêng cho chúng.\nGiá thay đổi tùy theo data source và region, đồng thời có thể thay đổi khi log sources mới được giới thiệu và log sources hiện có được tối ưu hóa để giảm chi phí và log volumes tặng giảm tùy theo hoạt động liên quan đến workload khác nhau của bạn trong AWS.\nBạn có thể sử dụng GuardDuty console hoặc API operation để ước tính chi phí sử dụng trung bình hàng ngày cho GuardDuty. Trong thời gian dùng thử miễn phí 30 ngày, ước tính chi phí sẽ dự đoán chi phí ước tính của bạn sau thời gian dùng thử. Nếu bạn đang hoạt động trong môi trường nhiều account, adminitrator account GuardDuty của bạn có thể giám sát số liệu chi phí cho tất cả các member accounts.\nỞ các Region được hỗ trợ, chủ account GuardDuty mới có thể dùng thử dịch vụ miễn phí trong 30 ngày và có quyền truy cập vào tất cả các tính năng (Bản dùng thử miễn phí Malware Protection chỉ khả dụng chi quá trình quét do GuardDuty khởi tạo) và phát hiện cac findings. GuardDuty console cho biết số ngày dùng thử miễn phí còn lại cũng như chi phí trung bình hàng ngày (dựa trên khối lượng data được phân tích và quét), giúp bạn không phải phỏng doán khi lập kế hoạch ngân sách.\nỞ thanh điều hướng bên trái, click vào Usage. Các ước tính được hiển trị trong GuardDuty console có thể khác một chút so với ước tính trong AWS Billing and Cost Mangagement console. Để biết thêm thông tin, xem ở đây.\nRetaining GuardDuty Findings Các security findings được lưu giữ và cung cáp thông qua GuardDuty console và API trong 90 ngày. Sau 90 ngày, findings sẽ bị loại bỏ. Để lưu giữ các findings lâu hơn 90 ngày, bạn có thể kích hoạt EventBridge để tự động đẩy các findings đến Amazon S3 bucket trong account của bạn hoặc một kho dữ liệu khác để lưu trữ lâu dài.\nGuardDuty hỗ trợ xuất các findings đang hoạt động sang CloudWatch Events và tùy chọn, sang Amazon S3 bucket. Các findings mới active mà GuardDuty tạo ra sẽ tự động được xuất trong vòng khoảng 5 phút sau khi findings được tạo. Bạn có thể đặt tuần suất xuất các bản cập nhật cho các active finding sang CloudWatch Events. Tần suất bạn chọn sẽ áp dụng cho việc xuất các lần xuất hiện mới của các findings hiện có sang CloudWatch Events, S3 bucket của bạn (nếu được config) và detective (nếu được tích hợp).\nAmazon S3 protection trong Amazon GuardDuty Tính năng bảo vệ S3 cho phép Amazon GuardDuty giám sát các hoạt động object-level API để xác định các rủi ro bảo mật tiềm ẩn đối với dữ liệu trong S3 bucket của bạn.\nGuardDuty giám sát các mối đe dọa đối với resource Amazon S3 của bạn bằng cách phân tích các sự kiện quản lí AWS CloudTrail và các data event CloudTrail S3. Các nguồn dữ liệu này giám sát các loại hoạt động khác nhau, ví dụ: các event management CloudTrail cho S3 bao gồm các hoạt động liệt kê hoặc configure các S3 buckets chẳng hạn như ListBuckets, DeleteBuckets và PutBucketReplication. Ví dụ về sự kiện dữ liệu cho S3 bao gồm các hoạt động object-level API, chẳng hạn như GetObject, ListObjects, DeleteObject và PutObject.\nTheo mặc định, tính năng giám sát GuardDuty đối với các sự kiện quả lí CloudTrail được bật cho tất cả các tài khoản đã bật GuardDuty và không thể config được. CloudTrail S3 data event logs là nguồn dữ liệu có thể config trong GuardDuty. Theo mặc định, tính năng bảo vệ S3 được bật cho các trình phát hiện mới, đối với các account được tạo trước khi bổ sung tính năng bảo vệ S3, nguồn dữ liệu này phải được bật theo cách thủ công. Các quy trình bật hoặc tắt tính năng giám data event S3 sẽ được đề cập trong chủ đề này.\nChúng tôi khuyên bạn nên bật tính năng bảo vệ S3 trong GuardDuty. Nếu tính năng này bị tắt, GuardDuty không thể giám sát đầy đủ hoặc tạo ra các phát hiện về hoạt động truy cập đáng ngờ vào dữ liệu được lưu trữ trong S3 bucket của bạn.\nĐể đảm bảo S3 Protection được kích hoạt, ở trang console, click vào S3 Protection dưới Protection plans ở thanh điều hướng bên trái. Xác nhận lại nó đã được enabled.\nMalware Protection trong Amazon GuardDuty Malware Protection giúp bạn phát hiện sự tiềm ẩn của phần mềm độc hại bằng cách quét các Amazon EBS được đính kèm với các Amazon EC2 instances và container workloads. Malware Protection cung cấp các tùy chọn quét để bạn có thể quyết định xem mình muốn bao gồm hay loại trừ các Amazon EC2 instance cụ thể và container workloads tại thời điểm quét. Nó cũng cung cấp tùy chọn để giữ lại snapshot của các Amazon EBS được đính kèm với các Amazon EC2 instances hoặc container workloads trong tài khoản GuardDuty của bạn. Snapshots chỉ được giữ lại khi tìm thấy phần mềm độc hại và tạo ra Malware Protection findings.\nMalware Protection cung cấp hai loại quét để phát hiện hoạt động độc hại tiềm ẩn trong các Amazon EC2 instances và container workloads của bạn – quét phần mềm độc hại do GuardDuty khởi tạo và quét phần mềm độc hại theo yêu cầu.\nĐể đảm bảo Malware Protection được kích hoạt, ở trang console, click vào Malware Protection dưới Protection plans ở thanh điều hướng bên trái. Xác nhận lại nó đã được enabled.\nRDS Protection in Amazon GuardDuty RDS Protection trong Amazon GuardDuty phân tích và lập profile login activity RDS để phát hiện các mối đe dọa truy cập tiềm ẩn vào cơ sở dữ liệu Amazon Aurora của bạn (Amazon Aurora MySQL-Compatible Edition và Aurora PostgreSQL-Compatible Edition). Tính năng này cho phép bạn xác định hành vi đăng nhập đáng ngờ. RDS Protection không yêu cầu cơ sở hạ tầng bổ sung, nó được thiết kế để không ảnh hưởng đến hiệu suất của các database instances của bạn.\nKhi RDS Protection phát hiện một nỗ lực đăng nhập bất thường hoặc đáng ngờ tiềm ẩn cho thấy mối đe dọa đối với cơ sở dữ liệu của bạn, GuardDuty sẽ tạo ra một findings mới cùng với các chi tiết về cơ sở dữ liệu có khả năng bị xâm phạm.\nBạn có thể bật hoặc tắt tính năng RDS Protection cho bất kỳ tài khoản nào ở bất kỳ AWS Region nào có tính năng này trong Amazon GuardDuty bất kỳ lúc nào.\nĐể đảm bảo RDS Protection được kích hoạt, ở trang console, click vào RDS Protection dưới Protection plans ở thanh điều hướng bên trái. Xác nhận RDS Login Activity Monitoring đã được enabled.\n"
},
{
	"uri": "/vi/2-guardduty/",
	"title": "Giới thiệu Amazon GuardDuty",
	"tags": [],
	"description": "",
	"content": "Nếu bạn chưa bao giờ sử dụng GuardDuty, hãy đọc rõ các mục trong phần này để nắm rõ các kiến thức nền tảng về service này.\nTổng quan Amazon GuardDuty Hiểu rõ GuardDuty finding Suppressing findings Build danh sách threat Tổng hợp các findings với Security Hub Thiết lập thông báo GuardDuty "
},
{
	"uri": "/vi/3-detective/3.2-iam/",
	"title": "Investigating compromised AWS IAM credentials bằng Amazon Detective",
	"tags": [],
	"description": "",
	"content": "Điều tra compromised role session với Amazon Detective Bạn hãy vào GuardDuty finding UnauthorizedAccess:IAMUser/MaliciousIPCaller.Custom và thực hiện remediate, bây giờ bạn sẽ điều tra thêm những gì đã xảy ra với resource này và tìm kiếm bất kỳ hoạt động đáng ngờ nào khác liên quan đến resource này hoặc bất kỳ hoạt động nào khác trong environment. Trong tình huống ứng phó sự cố, bạn sẽ có thể hành động khi bạn chắc chắn về những hành động cần thực hiện thường được xác định trong Incident Response playbooks (có thể sử dụng ví của playbooks). Đôi khi có thể cần đến Detective để xem xét một finding hoặc resource để xác định nên làm theo playbooks nào. Ví dụ: trong development environment, bạn có thể xóa resource nhanh hơn so với trong production environment có khả năng đưa ứng dụng trực tiếp vào trạng thái offline. Detective làm việc trong AWS Organization có thể giúp bạn điều tra tất cả các loại accounts và resources.\nPivot Detective Console Đầu tiên, các bạn hãy vào Amazon GuardDuty console. Sau đó chọn finding loại UnauthorizedAccess:IAMUser/MaliciousIPCaller.Custom. Ở phía trên bên phải, hãy click vào Investigate with Detective.\nỞ phần nhỏ hiện ra sau khi click, chúng ta chọn Role session.\nChi tiết về Role session Panel đầu tiên chúng ta thấy trong Role session entity là Role session details. Nó cung cấp cho bạn thông tin tổng quan về role session liên quan đến việc GuardDuty finding của chúng ta như associated account, assumed role among others.\nHãy nhìn khi role session được First observed và Last observed. Nó tương ứng như thế nào khi GuardDuty finidng lần đầu tiên được tạo ra và cập nhật? Thông tin này có thể giúp bạn thu hẹp time frame khi vai trò này bị xâm phạm.\nTiếp theo, bạn có thể muốn xác định xem đây có phải là IAM role được liên kết với production account hay không để xác định những gì bạn cần làm. Bạn có thể thực hiện việc này bằng cách tra cứu ID của AWS account trong configuration management database (CMBD) hoặc bất kỳ cách nào bạn tracking account, nhưng đối với tình huống này, hãy chọn Assume role để xem role được liên kết với session này.\nĐi sâu vào role details trong Detective console hoặc chọn AWS role để xem thông tin role trong IAM console. Từ IAM role, bạn sẽ có thể xác định role có những quyền gì, có tags nào giúp bạn xác định role đó được sử dụng để làm gì hay không và cung cấp cho bạn direct pivot point từ Detective để thu hồi các sessions như bạn đã làm trước đó.\nNhững findings liên quan đến resource. Nhìn vào phần Findings associated with this resource, bạn có thể tổng hợp các findings lại với nhau để hiểu rol này phù hợp như thế nào với vấn đề bảo mật tổng thể không?\nSử dụng search functionality để xem qua các finding. Nếu đây là admin account được ủy quyền của Detective, bạn có thể xem các findings trên nhiều accounts khác nhau như một data point để tiếp tục điều tra.\nTổng quan API call volume Ở trang Role sesion entity*, cuộn xuống panel Overall API call volume. Sau đó chọn Display details for scope time để mở rộng search window. Tiếp theo, hover vào horizontal line ở biểu dồ Successful calls. Cở sở cho các API calls thành công từ role session này là gì?\nTiếp theo, ở phía góc phải của panel Overall API call volume chọn Edit time window. Thay đổi scope time thành 24 hours trước khi GuardDuty finding được tạo ra mà set endtime là thời gian hiện tại. Nhìn vào thông tin để xác định IP addresses nào thực hiện API calls với role session và API methods nào được sử dụng. Tại thời điểm này, bạn có thể xem CloudTrail logs thông qua phương pháp truy vấn raw log data của mình, chẳng hạn như sử dụng Athena và Amazon Security Lake hoặc các giải pháp của đối tác bên thứ ba. Việc xem raw log data sẽ giúp bạn điều tra thêm chi tiết cụ thể về các API calls đã được thực hiện.\nTrong tình huống này, chúng ta đã sử dụng Amazon Detective để tìm thông tin giúp chúng ta hiểu được role liên quan đến vấn đề bảo mật. Ví dụ chúng ta có thể xác định xem đây là role có elevated permissions hay role được liên kết với production account? Với thông tin này, bạn sẽ có thể xác định playbook nào cần tuân theo khi phản hồi và khắc phục resource này. Trong production environment có nhiều dữ liệu hơn, bạn sẽ có thể tận dụng Detective nhiều hơn nữa cho những việc như observer activity, resource interaction và traffic baselining.\n"
},
{
	"uri": "/vi/2-guardduty/2.2-guardfinding/",
	"title": "Tìm hiểu về GuardDuty finding",
	"tags": [],
	"description": "",
	"content": "Ở phần trước, finding của GuardDuty thể hiện một vấn đề bảo mật tiềm ẩn được phát hiện trong network của bạn. GuardDuty đưa ra finding bất cứ khi nào nó thấy hoạt động bất ngờ và có khả năng gây hại trong AWS environment của bạn. Bạn có thể xem và quản lý các findings của GuardDuty trên trang Findings trong GuardDuty console hoặc bằng cách sử dụng các API operations hoặc GuardDuty CLI.\nTrong Amazon GuardDuty, ở thanh điều hướng bên trái, click vào Findings. Chọn một trong những finding trên trang. Nó sẽ mở ra tóm tắt của finding đó ở phần bên phải của trang. Chi tiết của finding dựa vào loại finding.\nTìm hiểu GuardDuty finding severity Amazon GuardDuty cung cấp ba severity levels (Low, Medium và High) để giúp khách hàng ưu tiên ứng phó trước các mối đe dọa tiềm ẩn. “Low” severity level cho biết hoạt động đáng ngờ hoặc độc hại đã bị chặn trước khi xâm phạm resource của bạn. “Medium” severity level cho biết hoạt động đáng ngờ. Ví dụ: một lượng lớn lưu lượng truy cập được trả về máy chủ từ xa đang ẩn sau Tor network hoặc hoạt động đi chệch khỏi hành vi thường được quan sát. \u0026ldquo;Cao\u0026rdquo; severity level cho biết resource được đề cập (ví dụ: EC2 instance hoặc tập hợp IAM user credentials) đã bị xâm phạm và đang được sử dụng cho các mục đích trái phép.\nNếu bạn muốn xem và tải về finding với JSON form, click vào Finding ID ở phần trên.\nQuản lí các GuardDuty findings Bạn cũng có tùy chọn archiving, exporting và unarchiving các findings. Việc archiving một finding sẽ lưu và dừng cảnh báo về finding đó. Exporting finding cho phép tải xuống finding hoàn chỉnh có định dạng JSON. Unarchiving một finding sẽ ngược lại với archiving. Chọn một finding bằng cách click vào checkbox bên cạnh finding.\nVới finding đã chọn, hãy click vào Action để hiện danh sách các action. Click vào \u0026ldquo;Archive\u0026rdquo; để lưu trữ finding.\nViệc lưu trữ finding sẽ ẩn nó khỏi danh sách các finding hiện tại. Để xem nó, hãy click vào Current để hiện danh sách các action và chọn Archived để xem các finding được lưu trữ.\nĐể hủy lưu trữ finding, hãy chọn finding đó rồi click vào Action để hiện danh sách các action và click vào Unarchive.\n"
},
{
	"uri": "/vi/3-detective/3.3-ec2/",
	"title": "Investigate compromised Ec2 instance bằng Amazon Detective",
	"tags": [],
	"description": "",
	"content": "Khi có thể, việc khắc phục bạn sẽ được thực hiện tự động hóa hoàn toàn. Sau khi khắc phục resource liên quan đến finding của GuardDuty, bạn có thể điều tra và phân tích thêm tác động mà vấn đề bảo mật này có thể gây ra đối với các resource khác và đảm bảo rằng không cần khắc phục cái gì khác. Tiếp theo, chúng ta sẽ sử dụng Amazon Detective để tiến hành phân tích nguyên nhân cốt lõi nhằm xác định mức độ nghiêm trọng của vấn đề bảo mật. Detective cung cấp cho bạn thông tin về bảo mật về các resource có liên quan trong một environment nhất định mà không cần tạo ra các truy vấn phức tạp theo thời gian và phạm vi.\nPivot Detective Console Đầu tiên, các bạn hãy vào Amazon GuardDuty console. Sau đó chọn finding loại UnauthorizedAccess:IAMUser/MaliciousIPCaller.Custom. Ở phía trên bên phải, hãy click vào Investigate with Detective.\nTrong tình huống này, chúng ta sẽ investigate EC2 instance liên quan đến GuardDuty finding, nhưng bạn sẽ nhận thấy rằng có một số tùy chọn khác nhau để pivot, chẳng hạn như chính GuardDuty finding, AWS account, session role, internal và external IP addresses. Chọn EC2 instance trong window mới được mở ra để investigate EC2 instance bị xâm phạm.\nBây giờ bạn sẽ được chuyển đến EC2 instance Detective profile liên quan đếnvGuardDuty finding ở trên. Như bạn có thể thấy, overall về finding của GuardDuty vẫn ở phía bên phải màn hình nên chúng ta có thể tiếp tục tham khảo khi cần tham khảo thông tin cụ thể liên quan đến finding đó.\nLưu ý rằng phạm vi thời gian để GuardDuty finding là từ khi event được thực hiện lần đầu tiên cho đến thời điểm event được GuardDuty thực hiện lần cuối. Cái này rất quan trọng vì scope time xác định data set mà Detective sẽ return cho bạn. Khi bạn làm bài workshop này, hãy thay đổi scope time sớm hơn và muộn hơn để xem liệu nó có thay đổi thông tin như các findings liên quan hoặc vị trí địa lý mới được quan sát hay không. Nếu bạn cần thêm thông tin về scope time, hãy vào đây để tìm hiểu thêm về Detective.\nChi tiết về EC2 instance Panel đầu tiên mà chúng tôi đã trình bày ở trang EC2 instance entity là EC instance details. Ở panel này, chúng ta sẽ tìm hieru thông tin tổng quan về EC2 instance liên kết với GuardDuty finding của chúng ta như create date, VPC association và role among others. Chúng ta có thể thấy những thông tin này được liên kết với nhau để chúng ta có thể pivot nó. Các bạn hãy chọn Role. Đây là role được gắn với EC2 instace. Các bạn sẽ thấy một cửa sổ mới có thông tin cụ thể về role entity mà bạn đã chọn. Xem qua thông tin về role và thu thập mọi bằng chứng quan trọng đối với bạn nếu bạn đang điều tra vấn đề bảo mật này. Quay trở lại trang EC2 instance entity. Đây là trang trước khi chúng ta pivot đến trang role entity.\nTiếp theo, chúng ta muốn xem những thông tin khác ma chúng ta có thể xác định về toàn bộ account. Hãy chọn AWS acocunt hyperlink trong panel EC2 instance details. Xem qua trang account entity và thu thập mọi bằng chứng quan trọng đối với ban nếu bạn đang điều tra vấn đề bảo mật này. Cuối cùng, hãy quay trở lại trang EC2 instance entity và tiếp tục phần tiếp theo.\nFindings và VPC flow logs Panel thứ hai trên trang profile Findings associated with this entity cho phép bạn suy luận xem có finding nào khác liên quan đến EC2 instance bị xâm phạm ngoài GuardDuty finding mà chúng ta hiện đang điều tra hay không. Finding profile sẽ liệt kê các địa chỉ IP, instance và account liên quan đến finding. Hãy xem xét các finding tổng hợp để xác định xem bức tranh tổng thể về vấn đề bảo mật có rõ ràng hơn hay không. Bạn có thể làm gì khi thấy những findings khác nhau? Tiếp theo, các bạn hãy cuộn xuống panel Overall VPC flow volume. Activity for time window sẽ tự động điều chỉnh thời gian theo scope time của cột và liệt kê địa chỉ IP, ports, lưu lượng truy cập vào và ra, protocol và notate xem lưu lượng truy cập được chấp nhận hay bị từ chối. Chọn display details for scope time ở cuối panel Overall VPC flow volume. Bây giờ bạn sẽ có khả năng filter VPC flow logs được liên kết với instance này như hình bên dưới.\nSử dụng filter functionality để tìm kiếm outbound DNS activity không liên kết với AWS managed DNS. Tiếp theo, chọn Edit time window và thay đổi thời gian nếu nó thay dổi VPC traffice baseline.\nNew behavior Cuộn lên đầu trang EC2 instance entity và chọn tab New behavior. Trong tab này, Detective sẽ đưa ra một bức tranh về hoạt động nào là bình thường trong organizeation của bạn và hoạt động nào là bất thường. Tuy nhiên, để có được bức tranh hoàn chỉnh hơn, Detective cần truy cập dữ liệu ít nhất hai tuần. tăng trưởng của Detective analysis cũng tăng theo số lượng account trong behavior graph. Hai tuần đầu tiên sau khi bạn kích hoạt Detective được coi là traning period.\nCuộn qua các panels khác nhau để xác định thông tin nào bạn có thể thu thập liên quan đến việc điều tra vấn đề bảo mật.\nSearch Ở đây, bạn hãy mở detail của GuardDuty finding ở phía bên phải màn hình. Hãy lưu ý IP address trong phần Actor của fnding details. Khi bạn có địa chỉ IP của tác nhân được liên kết với GuardDuty finding, hãy chọn Search ở thanh điều hướng ở bên trái.\nClick vào Choose type ở menu nhỏ. Chọn IP address trong phần Choose type. Nhập địa chỉ IP mà bạn đã note lại từ GuardDuty finding details ở trên và chọn Search ở bên phải màn hình. Chọn IP address hyperlink để điều hướng đến trang IP address entity.\nKhi bạn ở trên trang IP address entity, hãy lướt qua các panel khác nhau để thu thập thông tin về địa chỉ IP được liên kết với tác nhân:\nLần đầu tiên và lần cuối cùng nó được nhìn thấy là khi nào? Tác nhân này có liên quan đến các finding khác nhau của GuardDuty trong môi trường này không? Cuộn lên đầu trang IP address entity và chọn tab Resource interaction. Trong tab Resource interaction, chúng ta có thể xem được roles, users và AWS accounts nào mà địa chỉ IP này đã tương tác trong scope time. Nếu bạn thay đổi scope time thì có thay đổi panel resource interaction không?\nTrong tình huống này, chúng ta đã sử dụng Amazon Detective để tìm thông tin giúp chúng ta điều tra sự cố bảo mật với dữ liệu khá hạn chế. Trong production environment có nhiều dữ liệu hơn, bạn sẽ có thể tận dụng Detective nhiều hơn nữa cho những việc như observed activity, resource interaction và traffic baselining. Bạn đã sử dụng Amazon Detective để thu thập thêm thông tin về mức độ của sự cố bảo mật và các resources liên quan, bạn sẽ hiểu rõ hơn về các resources khác cần được khắc phục, các permissions cần được xác định phạm vi và nguyên nhân gốc rễ thông tin phân tích để đưa vào các báo cáo sau khi thực hiện, cùng nhiều thông tin khác.\n"
},
{
	"uri": "/vi/2-guardduty/2.3-supperessing/",
	"title": "Suppressing findings",
	"tags": [],
	"description": "",
	"content": "Suppression là một tập hợp các tiêu chí, bao gồm thuộc tính filter được ghép nối với một giá trị, được sử dụng để lọc các kết quả bằng cách tự động lưu trữ các finding mới phù hợp với tiêu chí đã chỉ định. Các suppression rules có thể được sử dụng để lọc các low-value filter, false positive findings hoặc các mối đe dọa mà bạn không có ý định xử lý, giúp dễ dàng nhận ra các mối đe dọa bảo mật có tác động lớn nhất đến môi trường của bạn.\nSau khi bạn tạo suppression rule, những finding mới phù hợp với tiêu chí được xác định trong quy tắc sẽ tự động được lưu trữ miễn là suppression rule vẫn còn hiệu lực. Bạn có thể sử dụng filter hiện có để tạo suppression rule hoặc suppression rule từ filter mới mà bạn xác định. Bạn có thể config các suppression rule để loại bỏ toàn bộ loại findings hoặc xác định tiêu chí filter chi tiết hơn để chỉ loại bỏ các trường hợp cụ thể của một loại finding cụ thể. Suppression rule của bạn có thể được chỉnh sửa bất kỳ lúc nào.\nCác suppression findings sẽ không được gửi tới AWS Security Hub, Amazon S3, Detective hoặc CloudWatch, giúp giảm mức độ finding noise nếu bạn sử dụng các finding của GuardDuty thông qua Security Hub, third-party SIEM hoặc các ứng dụng cảnh báo và yêu cầu khác.\nGuardDuty tiếp tục tạo ra các findings ngay cả khi chúng khớp với các suppression rules của bạn, tuy nhiên, những findings đó sẽ tự động được đánh dấu là đã lưu trữ. Kết quả được lưu trữ được lưu trữ trong GuardDuty trong 90 ngày và có thể được xem bất kỳ lúc nào trong khoảng thời gian đó. Bạn có thể xem các findings bị ẩn trong GuardDuty console bằng cách chọn Archived từ findings table hoặc thông qua API GuardDuty bằng cách sử dụng API ListFindings với tiêu chí FindingCriteria là service.archived bằng true.\nỞ môi trường multi-account chỉ có GuardDuty administrator có thể tạo suppression rules.\nTrong tình huống, chúng ta có một corporate server thực hiện quét các EC2 instances để tìm các open ports bằng nmap. Điều này tạo ra finding không mong muốn trong GuardDuty console, cách tốt nhất để giải quyết finding không mong muốn này là ngăn chặn finding đó. Server được xác định bằng tags \u0026ldquo;Name = Scanner\u0026rdquo; và \u0026ldquo;ENV = PROD\u0026rdquo;.\nCongfig rule để ngăn chặn finding không mong muốn Ở trang Findings, click vào Suppress Findings. Tiếp theo, trong phần Add filter criteria, chọn Instance Tag Value và nhập Scanner.\nTrước khi lưu lại suppression rule, bạn có thể xem lại những findings sẽ được ngăn chặn ở cuối trang.\nClick vào nút Apply, nhập SuppressPortScanner ở Name field và nhập Suppress all findings from the Prod port scanner. ở Description field. Cuối cùng, click vào nút Save.\n"
},
{
	"uri": "/vi/3-detective/",
	"title": "Sử dụng Amazon Detective để điều tra",
	"tags": [],
	"description": "",
	"content": "Phần này trình bày cách ứng phó sự cố với Amazon Detective cho 2 tình huống tương tự mà chúng ta thực hiện với Amazon GuardDuty nhưng sử dụng Detective làm công cụ điều tra.\n"
},
{
	"uri": "/vi/2-guardduty/2.4-threat/",
	"title": "Xây dựng threat list",
	"tags": [],
	"description": "",
	"content": "Amazon GuardDuty giám sát tính bảo mật của AWS environment của bạn bằng cách phân tích và xử lý VPC Flow Logs, AWS CloudTrail event logs và DNS logs. Bạn có thể tùy chỉnh phạm vi giám sát này bằng cách config GuardDuty để dừng cảnh báo cho các IP đáng tin cậy từ danh sách IP đáng tin cậy của riêng bạn và cảnh báo về các IP độc hại đã biết từ danh sách mối đe dọa của riêng bạn.\nTrusted IP lists và threat list chỉ áp dụng cho lưu lượng truy cập dành cho các địa chỉ IP có thể định tuyến công khai. Hiệu ứng của danh sách áp dụng cho tất cả các VPC Flow Log và CloudTrail findings nhưng không áp dụng cho các DNS findings.\nGuardDuty có thể được config để sử dụng các loại danh sách sau.\nTrusted IP lists Trusted IP lists bao gồm các địa chỉ IP mà bạn tin cậy để liên lạc an toàn với AWS infrastructure and applications của mình. GuardDuty không tạo ra các VPC Flow Log hoặc CloudTrail findings cho các địa chỉ IP trên trusted IP lists. Bạn có thể bao gồm tối đa 2000 địa chỉ IP và CIDR range trong một trusted IP list. Tại bất kỳ thời điểm nào, bạn chỉ có thể tải lên một trusted IP list cho mỗi tài khoản AWS ở mỗi Region.\nThreat lists Threat lists bao gồm các địa chỉ IP độc hại đã biết. Danh sách này có thể được cung cấp bởi thông tin về mối đe dọa của bên thứ ba hoặc được tạo riêng cho tổ chức của bạn. GuardDuty tạo ra các findings dựa trên threat lists. Bạn có thể bao gồm tối đa 250.000 địa chỉ IP và CIDR range trong một threat lists. GuardDuty chỉ tạo ra các findings dựa trên hoạt động liên quan đến địa chỉ IP và CIDR range trong threat lists của bạn, các findings sẽ không được tạo ra dựa trên domain names. Tại bất kỳ thời điểm nào, bạn có thể tải lên tối đa sáu threat lists cho mỗi tài khoản AWS cho mỗi Region.\nTrong multi-account environments, chỉ người dùng từ tài khoản administrator GuardDuty mới có thể tải lên và quản lý trusted IP lists cũng như threat lists. trusted IP lists và threat lists do account administrator tải lên sẽ được áp dụng cho GuardDuty functionality account member của nó. Nói cách khác, trong account member, GuardDuty tạo ra các findings dựa trên hoạt động liên quan đến các địa chỉ IP độc hại đã biết từ threat lists của administrator và không tạo ra các findings dựa trên hoạt động liên quan đến địa chỉ IP từ trusted IP lists của administrator.\nĐể biết thêm thông tin về trusted IP lists và threat lists, hãy đọc thêm thông tin ở đây\nTrong bài workshop này, chúng ta sẽ thêm một địa chỉ hư cấu vào threat lists.\nTạo file threat list Bước đầu tiên là tạo một text file (ví dụ như \u0026ldquo;my-threat-list.txt\u0026rdquo;) bằng Notepad. Text file này phải chứa một public IP duy nhất, hãy nhớ rằng các địa chỉ IP private không được hỗ trợ trong threat lists. Bạn hãy làm theo các bước dưới đây để tạo threat lists.\nUpload file lên S3 bucket Tiếp theo chúng ta hãy làm như dưới đây để upload threat list file lên S3 bucket. Đầu tiên hãy vào S3 console. Chọn S3 bucket đã được tạo trước đó sau đó click vào nút Upload. Trong trang Upload, click vào nút Add files và chọn file threat list đã tạo ở trên. Click vào nút Upload để upload file lên S3 bucket.\nThêm threat list vào GuardDuty Bây giờ, chúng ta sẽ add threat list được tải lên S3 bucket vào GuardDuty. Đầu tiên, các bạn hãy vào Amazon GuardDuty console. Ở phía bên trái chọn Lists, click vào nút Add a threat IP list.\nỞ mục List name, nhập Test Threat List. Ở dưới là Location, chúng ta nhập S3 URI đã được tạo trước đó. Chọn Format là Plaintext. Tick vào I agree và cuối cùng là click vào nút Add list.\nChúc ta cần phải activate list mà chúng ta vừa add vào GuardDuty. Làm như sau, chọn list vừa tạo, click vào nút Action và chọn Activate trong thanh menu nhỏ. Khi thanh status hiện như dưới, bạn đã thành công.\n"
},
{
	"uri": "/vi/2-guardduty/2.5-secuhub/",
	"title": "Tổng hợp findings bằng Security Hub",
	"tags": [],
	"description": "",
	"content": "AWS Security Hub là cloud service thực hiện các biện pháp kiểm tra bảo mật best practice, liên tục, tự động đối với AWS resource của bạn. Security Hub tổng hợp các cảnh báo bảo mật (tức là các findings) từ nhiều AWS services và sản phẩm của đối tác theo định dạng chuẩn hóa để bạn có thể dễ dàng xử lý chúng hơn. Để duy trì cái nhìn toàn diện về trạng thái bảo mật của bạn trong AWS, bạn cần tích hợp nhiều công cụ và service bao gồm threat detections từ Amazon GuardDuty, lỗ hổng từ Amazon Inspector, phân loại dữ liệu nhạy cảm từ Amazon Macie, các sự cố config resource từ AWS Config và AWS Partner Network Products. Security Hub đơn giản hóa cách bạn hiểu và cải thiện tình trạng bảo mật của mình bằng các biện pháp bảo mật best practice được tự động hóa được hỗ trợ bởi các AWS Config rules và tích hợp tự động với hàng tá dịch vụ AWS và partner products.\nCác Amazon GuardDuty findings trong Security Hub Đầu tiên các bạn hãy vào Security Hub console. Ở trang Security Hub Summary, cuộn xuống phần Latest findings from AWS Integrations. Click vào See findings kế bên Amazon GuardDuty. Nó sẽ mở ra trang Findings trong Security Hub console và điền trước các filter để hiển thị các findings từ Amazon GuardDuty.\n"
},
{
	"uri": "/vi/2-guardduty/2.6-noti/",
	"title": "Thiết lập GuardDuty notifications",
	"tags": [],
	"description": "",
	"content": "Amazon EventBridge là serverless event bus giúp xây dựng các ứng dụng event-driven trên quy mô lớn dễ dàng hơn bằng cách sử dụng các event được tạo từ AWS service. Ở phần trước, chúng ta đã tổng hợp các findings của GuardDuty bằng Security Hub. Trong phần này, chúng ta sẽ tạo EventBridge rule để tự động thông báo trên danh sách các findings được lọc mà chúng ta tổng hợp từ GuardDuty.\nAmazon SNS là service quản lí các message cho cả application-to-application (A2A) và application-to-person (A2P). Chúng ta sẽ config SNS notifications (email notifications) khi chúng ta thấy GuardDuty findings ở mức độ MEDIUM hoặc HIGH.\nBạn có thể assign metadata cho AWS resources của mình dưới dạng tags. Mỗi tag là một label bao gồm key và value do user xác định.\nConfig Amazon SNS topic Đầu tiên, các bạn hãy vào Amazon SNS console. Ở thanh điều hướng bên trái, click vào Topics, sau đó click vào Create topic. Chọn type Standard. Ở phần name, nhập production-guardduty-findings. Còn lại để mặc định, click vào nút Create topic ở cuối trang. Các bạn sẽ có kết quả như hình.\nSubscribe topic Từ trang topic production-guardduty-findings, chọn Create subscription. Ở trang Create subscription, ở dưới Protocol, chọn email. Tiếp theo, ở dưới phần Endpoint, nhập địa chỉ email mà bạn muốn dùng để nhận thông báo (Các bạn có thể unsubscribe ở cuối buổi). Và cuối cùng, click vào nút Create subscription. Kiểm tra lại email mà các bạn đã nhập, khoảng 2 phút, các bạn sẽ nhận được email.\nXác nhận subscription bằng cách click vào Confirm subscription ở trong email. Nó sẽ mở ra trang confirmation.\nTạo EventBridge rule để gửi findings đến topic Bây giờ, chúng ta đã subscribe SNS topic, đã sẵn sàng gửi findings đến đó. Vì chúng ta đang sử dụng Security Hub để tổng hợp các findings từ các security services khác, bao gồm cả GuardDuty, nên chúng ta sẽ tạo EventBridge rule để theo dõi các event từ Security Hub. Để thực hiện việc này, chúng ta sẽ tạo Event Bridge. Chúng ta sẽ config SNS notifications (email notifications) khi chúng ta nhận được kết quả có mức nghiêm trọng MEDIUM hoặc HIGH từ EC2 instance có PROD tag.\nHãy làm như sau, đầu tiên chúng ta vào Amazon EventBridge, click vào nút Create rule ở phía bên phải. Ở trang Define rule detail, đặt tên cho rule đó là production-guardduty-findings. Tiếp theo click vào Next. Ở trang Build event pattern, cuộn xuống Event pattern, click vào nút Edit pattern ở góc trái và thêm phần event patter dạng JSON dưới đây.\n{\r\u0026#34;source\u0026#34;: [\u0026#34;aws.securityhub\u0026#34;],\r\u0026#34;detail\u0026#34;: {\r\u0026#34;findings\u0026#34;: {\r\u0026#34;ProductName\u0026#34;: [\u0026#34;GuardDuty\u0026#34;],\r\u0026#34;Severity\u0026#34;: {\r\u0026#34;Label\u0026#34;: [\u0026#34;MEDIUM\u0026#34;, \u0026#34;HIGH\u0026#34;]\r},\r\u0026#34;Resources\u0026#34;: {\r\u0026#34;Type\u0026#34;: [\u0026#34;AwsEc2Instance\u0026#34;],\r\u0026#34;Tags\u0026#34;: {\r\u0026#34;ENV\u0026#34;: [\u0026#34;PROD\u0026#34;]\r}\r}\r}\r}\r} Tiếp theo, click vào Next, ở trang Select target(s), từ phần con, chọn SNS topic. Từ danh sách Topic, chúng ta chọn production-guardduty-findings. Tiếp theo, click Next, ở trang Configure tags - optional, click Next. Ở trang Review and create, click vào nut Create rule. Chúng ta đã tạo xong rule.\n"
},
{
	"uri": "/vi/categories/",
	"title": "Categories",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/vi/tags/",
	"title": "Tags",
	"tags": [],
	"description": "",
	"content": ""
}]